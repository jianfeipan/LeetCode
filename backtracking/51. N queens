/*
The n-queens puzzle is the problem of placing n queens on an n x n chessboard so that no two queens can attack each other.

A queen in a chessboard can attack horizontally, vertically, and diagonally.

Given an integer n, return all distinct solutions to the n-queens puzzle.

Each solution contains a unique board layout where the queen pieces are placed. 'Q' indicates a queen and '.' indicates an empty space.

You may return the answer in any order.

Example 1:



Input: n = 4

Output: [[".Q..","...Q","Q...","..Q."],["..Q.","Q...","...Q",".Q.."]]
Explanation: There are two different solutions to the 4-queens puzzle.

Example 2:

Input: n = 1

Output: [["Q"]]
Constraints:

1 <= n <= 8

*/

class Solution {
    // back track: try to put one, and dfs then change a place try to put on, then dfs

    // time O(n!) space O(n^2)
private:
    bool _canPutQueen(int row, int col, const vector<string>& board){
        int n = board.size();
        // |
        for(int r = 0; r<n; ++r) if(board[r][col] == 'Q') return false;
        // -
        for(int c = 0; c<n; ++c) if(board[row][c] == 'Q') return false;
        // \
        for(int r=row, c=col; r<n && c<n; ++r, ++c) if(board[r][c] == 'Q') return false;
        for(int r=row, c=col; r>=0 && c>=0; --r, --c) if(board[r][c] == 'Q') return false;

        // /
        for(int r=row, c=col; r>=0 && c<n; --r, ++c) if(board[r][c] == 'Q') return false;
        for(int r=row, c=col; r<0 && c>=0; ++r, --c) if(board[r][c] == 'Q') return false;

        return true;
    }
    
    void _dfs(vector<vector<string>>& res, int n, vector<string>& current, int row){
        if(row == n) {
            res.push_back(current);
            return;
        }
        // put one queue and recursively to next with from+1
        // where can I put next queue in current
        for(int col = 0; col<n; ++col){
            if(_canPutQueen(row, col, current)){
                current[row][col] = 'Q';
                _dfs(res, n, current, row+1);
                //back track
                current[row][col] = '.';
            }
        }
    }
public:
    vector<vector<string>> solveNQueens(int n) {
        vector<vector<string>> res;

        vector<string> current(n, string(n, '.'));
        _dfs(res, n, current, 0);

        return res;
    }
};
